Ráº¥t hay! Náº¿u báº¡n muá»‘n triá»ƒn khai Flask app trÃªn PythonAnywhere vÃ  táº¡o **nhiá»u API key** riÃªng biá»‡t, má»—i key chá»‰ Ä‘Æ°á»£c phÃ©p dÃ¹ng tá»‘i Ä‘a **10 láº§n**, thÃ¬ Ä‘Ã¢y lÃ  cÃ¡ch thá»±c hiá»‡n:

---

## âœ… Má»¥c tiÃªu:

* NgÆ°á»i dÃ¹ng truy cáº­p web cáº§n nháº­p má»™t **API key riÃªng biá»‡t (do báº¡n cáº¥p)**.
* Má»—i key chá»‰ **Ä‘Æ°á»£c dÃ¹ng tá»‘i Ä‘a 10 láº§n**, sau Ä‘Ã³ **vÃ´ hiá»‡u hÃ³a**.
* Báº¡n **quáº£n lÃ½ danh sÃ¡ch key + sá»‘ lÆ°á»£t dÃ¹ng** trÃªn server.

---

## ğŸ”§ CÃ¡ch triá»ƒn khai: DÃ¹ng dictionary hoáº·c database Ä‘á»ƒ kiá»ƒm tra key

### BÆ°á»›c 1: Táº¡o file chá»©a danh sÃ¡ch key

Táº¡o file `key_data.json` hoáº·c tÆ°Æ¡ng Ä‘Æ°Æ¡ng Ä‘á»ƒ lÆ°u:

```json
{
  "abc123": 0,
  "xyz789": 4,
  "token456": 9
}
```

> `abc123` lÃ  key, `0` lÃ  sá»‘ lÆ°á»£t Ä‘Ã£ dÃ¹ng.

---

### BÆ°á»›c 2: Code Flask kiá»ƒm tra key trÆ°á»›c khi xá»­ lÃ½ request

Trong `smart_programming_assistant.py`, thÃªm:

```python
import json
from flask import Flask, request, jsonify

app = Flask(__name__)

KEY_FILE = "key_data.json"
KEY_LIMIT = 10

def load_keys():
    with open(KEY_FILE, 'r') as f:
        return json.load(f)

def save_keys(data):
    with open(KEY_FILE, 'w') as f:
        json.dump(data, f)

@app.route('/api', methods=['POST'])
def handle_request():
    user_key = request.headers.get("X-API-KEY")  # hoáº·c request.form.get() náº¿u dÃ¹ng form

    if not user_key:
        return jsonify({"error": "API key is required."}), 401

    keys = load_keys()

    if user_key not in keys:
        return jsonify({"error": "Invalid API key."}), 403

    if keys[user_key] >= KEY_LIMIT:
        return jsonify({"error": "API key usage limit exceeded."}), 429

    # âœ… TÄƒng sá»‘ lÆ°á»£t dÃ¹ng
    keys[user_key] += 1
    save_keys(keys)

    # âœ… Xá»­ lÃ½ yÃªu cáº§u
    response_data = {"message": "Your request was processed!"}
    return jsonify(response_data)
```

---

### BÆ°á»›c 3: Gá»­i request cÃ³ kÃ¨m `X-API-KEY`

Tá»« trÃ¬nh duyá»‡t hoáº·c dÃ¹ng `curl`, hoáº·c báº¡n táº¡o má»™t **form nháº­p key** á»Ÿ frontend Ä‘á»ƒ ngÆ°á»i dÃ¹ng nháº­p vÃ o.

VÃ­ dá»¥ `curl`:

```bash
curl -X POST https://yourusername.pythonanywhere.com/api \
     -H "X-API-KEY: abc123"
```

---

### âœ… Quáº£n lÃ½ key nhÆ° tháº¿ nÃ o?

* Báº¡n táº¡o file `key_data.json` lÃºc Ä‘áº§u:

  ```json
  {
    "abc123": 0,
    "def456": 0,
    "ghi789": 0
  }
  ```

* Khi cáº§n thÃªm key má»›i:

  * VÃ o PythonAnywhere â†’ má»Ÿ **Bash console** â†’ sá»­a `key_data.json` hoáº·c viáº¿t Python nhá» Ä‘á»ƒ thÃªm key:

    ```python
    import json
    with open('key_data.json') as f:
        keys = json.load(f)
    keys['newkey123'] = 0
    with open('key_data.json', 'w') as f:
        json.dump(keys, f)
    ```

---

## ğŸ” LÆ°u Ã½ báº£o máº­t:

* Äá»«ng Ä‘á»ƒ ai Ä‘oÃ¡n Ä‘Æ°á»£c key cá»§a báº¡n â€” hÃ£y dÃ¹ng key dÃ i vÃ  ngáº«u nhiÃªn (`uuid4`, vÃ­ dá»¥).
* KhÃ´ng truyá»n key qua URL (`GET`), nÃªn dÃ¹ng `POST` hoáº·c header.

---

## âœ¨ NÃ¢ng cáº¥p sau nÃ y (náº¿u muá»‘n):

* LÆ°u key + lÆ°á»£t dÃ¹ng vÃ o SQLite thay vÃ¬ JSON â†’ nhanh hÆ¡n, dá»… query hÆ¡n.
* ThÃªm expiry theo thá»i gian (key háº¿t háº¡n sau 3 ngÃ y cháº³ng háº¡n).
* Giao diá»‡n admin Ä‘á»ƒ báº¡n xem danh sÃ¡ch key + reset thá»§ cÃ´ng.

---

Báº¡n muá»‘n mÃ¬nh táº¡o luÃ´n Ä‘oáº¡n code máº«u Ä‘áº§y Ä‘á»§ cÃ³ route nháº­p key vÃ  check limit khÃ´ng?
